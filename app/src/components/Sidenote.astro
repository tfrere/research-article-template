---

---

<div class="sidenote-container">
  <aside class="sidenote">
    <slot />
  </aside>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const containers = document.querySelectorAll(".sidenote-container");

    containers.forEach((container) => {
      // Trouve l'élément précédent (frère juste avant)
      const previousElement = container.previousElementSibling;

      if (previousElement) {
        // Rend le conteneur de la sidenote relatif à l'élément précédent
        previousElement.style.position = "relative";

        // Déplace le conteneur de la sidenote comme enfant de l'élément précédent
        previousElement.appendChild(container);

        // Style le conteneur pour qu'il se positionne correctement
        container.style.position = "absolute";
        container.style.top = "0";
        container.style.right = "-292px"; // 260px width + 32px gap
        container.style.width = "260px";

        // Affiche le container avec un fade-in
        container.style.display = "block";
        container.style.opacity = "0";

        // Fade-in avec transition
        setTimeout(() => {
          container.style.opacity = "1";
        }, 10);
      }
    });
  });
</script>

<style is:global>
  .sidenote-container {
    /* Caché par défaut, sera affiché par JS */
    display: none;
    margin: 12px 0;
    /* Transition pour le fade-in */
    transition: opacity 0.3s ease-in-out;
  }

  .sidenote {
    border-radius: 8px;
    padding: 0 30px;
    font-size: 0.9rem;
    color: var(--muted-color);
    margin: 0;
  }

  @media (--bp-content-collapse) {
    .sidenote-container {
      position: static !important;
      width: auto !important;
      right: auto !important;
      top: auto !important;
      margin-top: 8px;
      /* Affichage normal sur mobile */
      display: block !important;
      opacity: 1 !important;
    }

    .sidenote {
      padding: 0;
    }
  }
</style>
